(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{8941:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/parcels",function(){return s(198)}])},8385:function(e,t,s){"use strict";var r=s(5893),n=s(4983),i=s.n(n),l=s(1664),a=s.n(l);t.Z=()=>(0,r.jsxs)(a(),{href:"/profile/parcels/create",className:i().btn,children:[(0,r.jsx)("span",{children:"+"}),(0,r.jsx)("p",{children:"Добавить посылку"})]})},9400:function(e,t,s){"use strict";var r=s(5893),n=s(7294),i=s(9573),l=s.n(i),a=s(1163),o=s(9460),c=s(1664),d=s.n(c);t.Z=e=>{let{children:t}=e,s=(0,o.O_)(),i=(0,a.useRouter)(),c=(0,o.ac)("(min-width: 576px)");return(0,n.useEffect)(()=>{let e=document.body;return e.style.backgroundColor="#F4F5FE",()=>{e.removeAttribute("style")}},[]),s&&(0,r.jsxs)(r.Fragment,{children:[c||"/profile"===i.pathname?(0,r.jsx)("nav",{className:l().nav,children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:(0,r.jsx)(d(),{href:"/profile/addresses",children:"Мои адреса"})}),(0,r.jsx)("li",{children:(0,r.jsx)(d(),{href:"/profile/parcels",children:"Мои посылки"})}),(0,r.jsx)("li",{children:(0,r.jsx)(d(),{href:"/profile/settings",children:"Личные данные"})}),(0,r.jsx)("li",{children:(0,r.jsx)(d(),{href:"/profile/nsettings",children:"Настройка уведомлений"})})]})}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("section",{children:(0,r.jsx)("div",{className:l().container,children:t})})]})}},2929:function(e,t,s){"use strict";var r=s(5893),n=s(7211),i=s.n(n),l=s(1163),a=s(3967),o=s.n(a);t.Z=()=>{let e=(0,l.useRouter)(),t="/profile/parcels",s="/profile/addresses";return(0,r.jsxs)("div",{className:i().switch,children:[(0,r.jsx)("button",{className:o()(i().button,{[i().active]:e.pathname===t}),onClick:()=>e.replace(t),children:"Мои посылки"}),(0,r.jsx)("button",{className:o()(i().button,{[i().active]:e.pathname===s}),onClick:()=>e.replace(s),children:"Мои адреса"})]})}},198:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return D},default:function(){return L}});var r=s(5893),n=s(7294),i=s(1996),l=s.n(i),a=s(8045),o=s(1163),c=s(9460),d=s(5675),h=s.n(d),x=s(6501),p=s(5121);s(8765);let u=()=>(0,r.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 448 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"})}),j=()=>(0,r.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 320 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"})});var f=s(8688),g=s(9400),m=s(8385),y=()=>(0,r.jsxs)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})]}),_=()=>(0,r.jsxs)("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,r.jsx)("path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"}),(0,r.jsx)("path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"}),(0,r.jsx)("path",{d:"M16 5l3 3"})]}),b=s(5811),v=[{key:0,value:"Добавлено"},{key:1,value:"На складе"},{key:2,value:"Готово к отправлению"},{key:3,value:"В пути"},{key:4,value:"В стране"},{key:5,value:"На доставке"},{key:6,value:"Доставлено"}],w=s(3171),k=s(2929),P=s(1955),C=s(5678);s(2130);var S=s(9760),W=s(7120),Z=s.n(W),N=s(4875),z=()=>{let e=Date.now().toString(),t=Math.floor(1e5+9e5*Math.random()).toString();return e.slice(-4)+t},F=s(1664),A=s.n(F),T=s(3454);let M={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};var E=e=>{let{user_id:t}=e,[s,i]=(0,n.useState)(!1),[l,a]=(0,n.useState)({amount:0}),o=P.Z.get("access_token"),c=()=>i(!1),d=async e=>{e.preventDefault();let s=Object.fromEntries(new FormData(e.currentTarget)),r=z(),n=T.env.NEXT_PUBLIC_URL+"/profile/parcels";try{let{data:e}=await p.Z.postForm("https://epay-oauth.homebank.kz/oauth2/token",{grant_type:"client_credentials",scope:"webapi usermanagement email_send verification statement statistics payment",client_id:"test",client_secret:"yF587AV9Ms94qN2QShFzVR3vFnWkhjbAK3sG",invoiceID:r,amount:s.amount,currency:"KZT",terminal:"67e34d63-102f-4bd1-898e-370781d0074d"}),i=document.createElement("script");i.src="https://epay.homebank.kz/payform/payment-api.js",i.onload=()=>{window.halyk.showPaymentWidget({invoiceId:r,invoiceIdAlt:r,backLink:n,failureBackLink:n,language:"RUS",description:"Оплата на сайте oryx.kz",terminal:"67e34d63-102f-4bd1-898e-370781d0074d",amount:s.amount,currency:"KZT",auth:e},async e=>{e.success?(await p.Z.post("".concat("https://cms.oryx.kz/api","/transactions"),{user_id:t,order:r,tenge:s.amount,type:0,outgo:0},{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(o)}}),C.Am.success("Оплата прошла успешно! \uD83C\uDF89. Страница сейчас перезагрузится."),setTimeout(()=>{window.location.reload()},2e3)):C.Am.error("Оплата отменена. Попробуйте снова.")})},document.body.appendChild(i)}catch(e){C.Am.error("Ошибка при инициализации платежа. Проверьте данные.")}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(C.Ix,{}),(0,r.jsx)("button",{onClick:()=>i(!0),className:Z().btn,children:"Пополнить баланс"}),(0,r.jsx)(N.Z,{open:s,onClose:c,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,r.jsxs)(S.Z,{sx:M,children:[(0,r.jsx)("strong",{style:{fontSize:"20px",borderBottom:"1px solid #E65A57"},children:"Пополнение баланса"}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)("form",{onSubmit:d,style:{display:"flex",flexDirection:"column"},children:[(0,r.jsx)("label",{htmlFor:"amount",style:{fontSize:"16px",fontWeight:"600"},children:"Сумма:"}),(0,r.jsx)("input",{type:"number",name:"amount",id:"amount",min:"0",step:"0.01",onChange:e=>a({...l,amount:parseFloat(e.target.value)}),required:!0,style:{padding:"10px",border:"1px solid #ccc",borderRadius:"5px",margin:"10px 0"}}),(0,r.jsx)("button",{type:"submit",onClick:()=>setTimeout(()=>c(),500),style:{marginTop:"10px",width:"100%",padding:"10px 20px",backgroundColor:"#E65A57",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Оплатить"}),(0,r.jsxs)("b",{style:{fontSize:"12px",marginTop:"10px"},children:["Нажимая на кнопку ",(0,r.jsx)("q",{children:"Оплатить"}),", вы соглашаетесь с",(0,r.jsx)("br",{}),(0,r.jsx)(A(),{href:"/obshchie-usloviya",style:{borderBottom:"1px solid #f1f1f1"},children:"условиями нашего сервиса"})]})]})]})})]})},R=s(9008),B=s.n(R),D=!0,L=e=>{var t,s;let{parcels:i,recipients:d,user_id:C,total_unpaid_price:S}=e,[W,Z]=(0,n.useState)({state:!1,data:{}}),[N,z]=(0,n.useState)(""),F=(0,c.O_)(),A=(0,c.ac)("(min-width: 576px)"),T=(0,n.useRef)(null),M=(0,o.useRouter)(),R=e=>{W.state&&W.data.id===e.id?Z({state:!1,data:{}}):Z({state:!0,data:e})},D=()=>{Z({state:!1,data:{}})};(0,c.t$)(T,D);let L=async e=>{let t=x.ZP.loading("Загрузка...");try{await p.Z.delete("/api/profile/delete-parcel/".concat(e)),x.ZP.success("Посылка удалена"),M.replace(M.asPath)}catch(e){x.ZP.error("Ошибка при удалении посылки")}finally{x.ZP.dismiss(t)}};(0,n.useEffect)(()=>{D()},[M]);let q=async e=>{try{let t=P.Z.get("access_token");await b.Z.post("/parcels/".concat(e,"/pay"),{},{headers:{Authorization:"Bearer ".concat(t)}}),x.ZP.success("Посылка успешно оплачена! Страница буде перезагружена."),setTimeout(()=>{window.location.reload()},1e3)}catch(e){x.ZP.loading("Производится оплата посылки. Страница будет перезагрежена."),setTimeout(()=>{window.location.reload()},3e3)}},O=e=>{(0,a._1)({title:"Подтверждение оплаты",message:"Вы уверены, что хотите оплатить эту посылку?",buttons:[{label:"Да",onClick:()=>q(e)},{label:"Нет",onClick:()=>(0,x.ZP)("Оплата отменена")}]})};return F&&(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(B(),{children:(0,r.jsx)("title",{children:"Мои посылки"})}),(0,r.jsxs)("div",{className:l().wrapper,children:[(0,r.jsxs)("div",{className:l().left,children:[(0,r.jsx)("h1",{children:"Список ваших посылок"}),(0,r.jsx)("p",{children:"Вся информация о ваших посылках и их статусах"}),!A&&(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,r.jsx)(m.Z,{}),(0,r.jsx)(E,{user_id:C}),(0,r.jsx)(k.Z,{})]}),(0,r.jsxs)("form",{className:l().formik,onSubmit:e=>{e.preventDefault(),z(e.target[0].value)},children:[A?(0,r.jsx)("input",{type:"search",placeholder:"Поиск по треку"}):(0,r.jsxs)("label",{htmlFor:"track",children:["Поиск по трек-номеру",(0,r.jsx)("input",{type:"text",id:"track",placeholder:"Трек-номер"}),(0,r.jsx)("button",{type:"submit",className:l().search__btn,children:(0,r.jsx)(h(),{src:"/search.svg",alt:"search",width:24,height:24})})]}),A&&(0,r.jsxs)("select",{name:"status",defaultValue:M.query.status,onChange:e=>{if(""===e.target.value){let{status:e,...t}=M.query;M.replace({pathname:M.pathname,query:t});return}M.replace({pathname:M.pathname,query:{...M.query,status:e.target.value}})},children:[(0,r.jsx)("option",{value:"",children:"Все"}),v.map(e=>(0,r.jsx)("option",{value:e.key,children:e.value},e.key))]}),(0,r.jsx)("button",{type:"submit",children:"Поиск"}),(0,r.jsx)("button",{type:"reset",children:"Очистить"})]}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"10px",textAlign:"center"},children:(0,r.jsxs)("span",{style:{fontSize:"1.2em",fontWeight:"bold",backgroundColor:"#ffffff",padding:"12px",borderRadius:"25px 25px 25px 0",color:0===S?"green":"#ff0000",marginLeft:"10px",margin:"10px"},children:[(0,r.jsx)("span",{style:{fontSize:"18px",color:"black",marginRight:"6px"},children:"Общая сумма к оплате:"}),S,"$"]})}),!A&&W.state?(0,r.jsxs)("div",{className:l().card,children:[(0,r.jsx)("b",{children:"Трек-номер"}),(0,r.jsxs)("div",{className:l().card__head,children:[(0,r.jsx)("button",{onClick:()=>Z({state:!1,data:{}}),children:(0,r.jsx)(h(),{src:"/arrow-left.svg",alt:"arrow-left",width:16,height:16})}),(0,r.jsx)("span",{style:{fontWeight:"600",color:"#000"},children:W.data.track}),(0,r.jsx)(h(),{src:"/warn.svg",alt:"warn",width:24,height:24})]}),(0,r.jsxs)("div",{className:l().card__fields,style:{fontWeight:"600",color:"#000"},children:[(0,r.jsxs)("label",{htmlFor:"status",children:[(0,r.jsx)("b",{children:"Статус"}),(0,r.jsx)("input",{type:"text",id:"status",value:v[+W.data.status].value,style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{htmlFor:"recipient",children:[(0,r.jsx)("b",{children:"Получатель"}),(0,r.jsx)("input",{type:"text",id:"recipient",value:W.data.recipient_fio,style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{htmlFor:"weight",children:[(0,r.jsx)("b",{children:"Вес"}),(0,r.jsx)("input",{type:"text",id:"weight",value:W.data.weight||"Не указан",style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{htmlFor:"prod_price",children:[(0,r.jsx)("b",{style:{fontWeight:"600",color:"#000"},children:"Стоимость доставки"}),(0,r.jsx)("input",{type:"text",id:"prod_price",value:+W.data.prod_price>0?W.data.prod_price:"Не указан",style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("b",{style:{fontWeight:"600",color:"#000"},children:"Дата добавления"}),(0,r.jsx)("input",{type:"text",value:W.data.created_at?(0,w.Z)(W.data.created_at):"",style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("b",{style:{fontWeight:"600",color:"#000"},children:"Направление"}),(0,r.jsx)("input",{type:"text",value:"".concat(1==+(null!==(s=W.data.city_out)&&void 0!==s?s:0)?"Нью-Йорк":"Делавэр"," - ").concat(W.data.city),style:{fontWeight:"600",color:"#000"},disabled:!0})]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("b",{style:{fontWeight:"600",color:"#000"},children:"Стоимость доставки"}),(0,r.jsx)("input",{type:"text",value:void 0!==W.data.prod_price&&+W.data.prod_price>0?"".concat(W.data.prod_price,"₸"):"Не указано",style:{fontWeight:"600",color:"#000"},disabled:!0})]})]}),(0,r.jsxs)("div",{className:l().card__info,children:[(0,r.jsxs)("strong",{children:["Оплачен:",(0,r.jsx)("span",{style:{fontWeight:"600",marginLeft:"10px"},children:"1"===W.data.payed?"Да":"Нет"})]}),(0,r.jsx)("strong",{children:"Товары:"}),(0,r.jsx)("ul",{style:{backgroundColor:"#f5f5f5",padding:"5px",borderRadius:"5px"},children:null===(t=W.data.goods)||void 0===t?void 0:t.map(e=>(0,r.jsxs)("li",{style:{fontWeight:"600",backgroundColor:"#fff",padding:"5px"},children:[e.name," ",e.price,"USD"===e.currency||"$"===e.currency?"$":"€"]},e.id))})]})]}):(0,r.jsx)("div",{ref:T,className:l().data,children:(0,r.jsx)("table",{children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Трек-код"}),(0,r.jsx)("th",{children:"Статус"}),A&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("th",{children:"Дата добавления"}),(0,r.jsx)("th",{children:"Направление"}),(0,r.jsx)("th",{children:"Стоимость доставки"}),(0,r.jsx)("th",{})]}),(0,r.jsx)("th",{style:{fontWeight:"400"},children:"Оплата"})]}),i.filter(e=>e.track.includes(N)).map(e=>{var t;return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.track}),(0,r.jsxs)("td",{children:[(0,r.jsx)("b",{children:v[+e.status]?(0,r.jsx)("b",{children:v[+e.status].value}):(0,r.jsx)("b",{children:"Статус неизвестен"})}),(0,r.jsx)("button",{onClick:()=>R(e),children:W.state&&W.data.id===e.id?(0,r.jsx)(u,{}):(0,r.jsx)(j,{})})]}),A&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("td",{children:(0,w.Z)(e.created_at)}),(0,r.jsxs)("td",{children:[1==+e.city_out?"Нью-Йорк":"Делавэр","- ",e.city]}),+e.prod_price>0?(0,r.jsxs)("td",{children:[e.prod_price,"₸"]}):(0,r.jsx)("td",{children:"Не указано"}),(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{onClick:()=>L(e.id),children:(0,r.jsx)(y,{})}),(0,r.jsx)("button",{children:(0,r.jsx)(_,{})}),(0,r.jsx)("button",{onClick:()=>R(e),children:W.state&&W.data.id===e.id?(0,r.jsx)(u,{}):(0,r.jsx)(j,{})})]})]}),(0,r.jsx)("td",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)("button",{disabled:1==+e.payed,onClick:()=>O(e.id),style:{width:"40px",height:"40px",color:"white",fontWeight:"500",backgroundColor:1==+e.payed?"green":"#EB3738",borderRadius:"50%",border:"none",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)",transition:"all 0.2s ease-in-out",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none"},onMouseOver:e=>{e.currentTarget.style.boxShadow="0 6px 8px rgba(0, 0, 0, 0.2), 0 3px 6px rgba(0, 0, 0, 0.15)"},onMouseOut:e=>{e.currentTarget.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)"},title:1==+e.payed?"Посылка оплачена":"Оплатить посылку",children:"$"})})]}),A&&W.state&&W.data.id===e.id&&(0,r.jsx)("tr",{style:{textAlign:"left"},children:(0,r.jsx)("td",{colSpan:6,children:(0,r.jsx)("table",{children:(0,r.jsx)("tbody",{children:null===(t=W.data.goods)||void 0===t?void 0:t.map(e=>(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("td",{style:{textAlign:"left"},children:[(0,r.jsx)("strong",{children:"Наименование товара:"}),"\xa0\xa0",e.name]}),(0,r.jsxs)("td",{style:{textAlign:"left"},children:[(0,r.jsx)("strong",{children:"Цена посылки:"}),"\xa0\xa0",e.price,"$"]}),(0,r.jsxs)("td",{style:{textAlign:"left"},children:[(0,r.jsx)("strong",{children:"Доп. услуга:"}),"\xa0\xa0",e.additional_function||"Не указано"]}),(0,r.jsxs)("td",{style:{textAlign:"left"},children:[(0,r.jsx)("strong",{children:"Город:"}),"\xa0\xa0",W.data.city]}),(0,r.jsxs)("td",{style:{textAlign:"left"},children:[(0,r.jsx)("strong",{children:"Получатель:"}),"\xa0\xa0",W.data.recipient_fio]})]},e.id))})})})})]},e.id)})]})})})]}),(0,r.jsx)("div",{className:l().right,children:A?(0,r.jsxs)("div",{className:l().paba,children:[(0,r.jsx)(m.Z,{}),(0,r.jsx)(E,{user_id:C})]}):(0,r.jsx)(h(),{src:"/man.svg",alt:"man",...f.v,style:{width:"100%",maxHeight:"400px"},priority:!0})})]})]})}},3171:function(e,t){"use strict";t.Z=e=>{let t=new Date(e),s=t.getDate(),r=t.getMonth()+1,n=t.getFullYear(),i=t.getHours(),l=t.getMinutes(),a=e=>e<10?"0"+e:e;return"".concat(a(s),".").concat(a(r),".").concat(n,", ").concat(a(i),":").concat(a(l))}},8688:function(e,t,s){"use strict";s.d(t,{v:function(){return r}});let r={width:0,height:0,sizes:"100vw",style:{width:"100%",height:"100%"}}},7120:function(e){e.exports={btn:"styles_btn__DjXZs"}},4983:function(e){e.exports={btn:"styles_btn__EtVal"}},9573:function(e){e.exports={nav:"styles_nav__uws43",container:"styles_container__kz_bG"}},7211:function(e){e.exports={switch:"styles_switch__RTE57",active:"styles_active__FO7C2"}},1996:function(e){e.exports={wrapper:"ProfileParcels_wrapper__4o4jy",left:"ProfileParcels_left__TASye",formik:"ProfileParcels_formik__eGPGq",search__btn:"ProfileParcels_search__btn__BqnTB",data:"ProfileParcels_data__T9RWb",bottom:"ProfileParcels_bottom__B25X8",card:"ProfileParcels_card__hvUSz",card__head:"ProfileParcels_card__head__R_L2v",card__fields:"ProfileParcels_card__fields__MQIzW",card__info:"ProfileParcels_card__info__h0SwH",right:"ProfileParcels_right__6OSr8",paba:"ProfileParcels_paba__WsYrP"}}},function(e){e.O(0,[83,121,888,774,179],function(){return e(e.s=8941)}),_N_E=e.O()}]);